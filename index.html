<!DOCTYPE html>
<html lang="es-AR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="css/styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200&amp;_cacheOverride=1759272061882" rel="stylesheet">
    <link rel="icon" href="assets/images/icon.png" type="image/x-icon">
    <title>INICIO | Gabba</title>
    <script>
      document.addEventListener('DOMContentLoaded', () => {
    const savedMode = localStorage.getItem('darkMode');
    if (savedMode === 'off') {
        document.body.classList.remove('dark-mode');
    } 
});
    </script>
</head>
<body class="dark-mode">
    <header>
        <h1>GABBA</h1>
        <img src="assets/images/icon.png" alt="">
    </header>
    <main>
        <section class="index">
            <h2>PROGRAMAS</h2>
            <div class="search-container">
                <div class="input-wrapper">
                    <span class="material-symbols-rounded">search</span>
                    <input type="text" id="radioSearch" placeholder="Buscar programa..." />
                </div>
                <span id="radioClearBtn" class="clear-icon material-symbols-rounded">close_small<span class="icon"></span></span>
                <div class="search-suggestions">
                    <button data-filter="live">Gabba Gabba Live</button>
                    <button data-filter="acustico">Acústicos</button>
                    <button data-filter="especial">Especiales</button>
                </div>
            </div>
            <div class="video-scroll-wrapper">
                <div class="video-scroll" id="radio-container">
                </div>
            </div>
        </section>
        <section class="index">
            <h2>VIDEOS</h2>
            <div class="search-container">
                <div class="input-wrapper">
                    <span class="material-symbols-rounded">search</span>
                    <input type="text" id="videoSearch" placeholder="Buscar video..." />
                </div>
                <span id="videoClearBtn" class="clear-icon material-symbols-rounded">close_small<span class="icon"></span></span>
                <div class="search-suggestions">
                    <button data-filter="cobertura">Coberturas</button>
                    <button data-filter="resumen">Resúmenes</button>
                </div>
            </div>
            <div class="video-scroll-wrapper">
                <div class="video-scroll" id="video-container">
                </div>
            </div>
        </section>
        <section class="index">
            <h2>PRÓXIMA FECHA</h2>
            <div class="event-section" id="event-container">
            </div>
        </section>
    </main>
    <div class="image-overlay" id="imageOverlay">
        <span class="close-btn material-symbols-rounded" id="closeBtn">close_small</span>
        <img src="" alt="Imagen ampliada" class="overlay-img" id="overlayImg">
    </div>
    <footer>
        © 2025 FIESTA RAMONA
    </footer>
    <nav>
        <div class="nav-wrapper">
            <a href="pastevents.html">
                <span class="material-symbols-rounded">event_repeat</span>
                <span>Eventos</span>
            </a>
            <a href="news.html">
                <span class="material-symbols-rounded">newspaper</span>
                <span>Noticias</span>
            </a>
            <a href="#" class="icon-active">
                <span class="material-symbols-rounded">home
                </span>
                <span>Inicio</span> 
            </a>
            <a href="links.html">
                <span class="material-symbols-rounded">link</span>
                <span>Links</span>
            </a>
            <a href="settings.html">
                <span class="material-symbols-rounded">settings</span>
                <span>Opciones</span>
            </a>
        </div>
    </nav>
    
    <script>
        function setupSearch(searchInputId, clearBtnId, containerId) {
  const searchInput = document.getElementById(searchInputId);
  const clearBtn = document.getElementById(clearBtnId);
  const container = document.getElementById(containerId);
  const wrapper = container.closest('.video-scroll-wrapper');
  const searchContainer = searchInput.closest('.search-container');
  const suggestionButtons = searchContainer.querySelectorAll('.search-suggestions button');

  clearBtn.style.visibility = 'hidden';

  function handleScrollShadow() {
    if (!wrapper) return;
    
    const scrollLeft = container.scrollLeft;
    const scrollWidth = container.scrollWidth;
    const clientWidth = container.clientWidth;
    
    const isAtEnd = scrollLeft + clientWidth >= scrollWidth - 5;
    
    wrapper.classList.toggle('hide-end-shadow', isAtEnd);
  }

  container.addEventListener('scroll', handleScrollShadow);
  
  handleScrollShadow();

  function filterVideos(filterTerm = searchInput.value.toLowerCase().trim(), isFilterButton = false) {
    const hasQuery = filterTerm.length > 0;
    const videoItems = container.querySelectorAll('.video-item');

    videoItems.forEach(item => {
      const isSeasonHeader = item.querySelector('.video-placeholder') !== null;
      if (isSeasonHeader) {
        item.style.display = 'none';
        return;
      }

      const titleEl = item.querySelector('.video-title');
      const title = titleEl?.textContent?.toLowerCase() || '';
      const season = item.getAttribute('data-temporada')?.toLowerCase() || '';
      const tags = item.getAttribute('data-tags')?.toLowerCase() || '';

      const matches = title.includes(filterTerm) || 
            season.includes(filterTerm) ||
              `temporada ${season}`.includes(filterTerm) ||
                  tags.includes(filterTerm);

      item.style.display = matches ? 'block' : 'none';
    });

    let currentSeason = null;
    let hasVisibleVideos = false;
    videoItems.forEach(item => {
      const isSeasonHeader = item.querySelector('.video-placeholder') !== null;
      if (isSeasonHeader) {
        if (hasVisibleVideos && currentSeason !== null) {
          item.style.display = 'block';
        }
        currentSeason = item.querySelector('.video-placeholder')?.textContent?.toLowerCase() || null;
        hasVisibleVideos = false;
      } else if (item.style.display === 'block') {
        hasVisibleVideos = true;
      }
    });

    if (!isFilterButton) {
      clearBtn.style.visibility = hasQuery ? 'visible' : 'hidden';
    } else {
      clearBtn.style.visibility = 'hidden';
    }

    if (wrapper) {
      wrapper.classList.toggle('hide-shadow', hasQuery);
      handleScrollShadow();
    }
  }

  searchInput.addEventListener('input', () => {
    suggestionButtons.forEach(btn => {
      btn.classList.remove('active');
      const closeBtn = btn.querySelector('.close-filter');
      if (closeBtn) {
        closeBtn.remove();
      }
    });
    filterVideos(); 
  });

  suggestionButtons.forEach(button => {
    button.addEventListener('click', (e) => {
      e.preventDefault(); 
      const filterTerm = button.getAttribute('data-filter')?.toLowerCase() || '';
      
      suggestionButtons.forEach(btn => {
        btn.classList.remove('active');
        const closeBtn = btn.querySelector('.close-filter');
        if (closeBtn) {
          closeBtn.remove();
        }
      });
      
      button.classList.add('active');
      
      filterVideos(filterTerm, true);
      
      
      const isMobile = 'ontouchstart' in window || navigator.maxTouchPoints > 0;
      if (!isMobile) {
        searchInput.focus();
      }
      
      const closeBtn = document.createElement('span');
        closeBtn.className = 'material-symbols-rounded close-filter';
        closeBtn.textContent = 'close';
      closeBtn.addEventListener('click', (e) => {
        e.stopPropagation();
        button.classList.remove('active');
        searchInput.value = '';
        filterVideos('', false);
        closeBtn.remove();
      });
      button.appendChild(closeBtn);
    });
    
    button.addEventListener('touchend', (e) => {
      if (document.activeElement && document.activeElement !== document.body) {
        document.activeElement.blur();
      }
    });
  });

  searchInput.addEventListener('focus', () => {
    wrapper?.classList.add('hide-shadow');
  });

  searchInput.addEventListener('blur', () => {
    if (searchInput.value.trim() === '') {
      wrapper?.classList.remove('hide-shadow');
    }
  });

  clearBtn.addEventListener('click', () => {
    searchInput.value = '';
    filterVideos('', false);
    searchInput.blur();
    
    suggestionButtons.forEach(btn => {
      btn.classList.remove('active');
      const closeBtn = btn.querySelector('.close-filter');
      if (closeBtn) {
        closeBtn.remove();
      }
    });
  });
}

document.addEventListener('DOMContentLoaded', () => {
  setupSearch('radioSearch', 'radioClearBtn', 'radio-container');
  setupSearch('videoSearch', 'videoClearBtn', 'video-container');
});
    </script>
    <script>
async function cargarProgramas() {
    try {
        const response = await fetch('https://gabbaapp.s3.us-east-1.amazonaws.com/radio.json?t=' + Date.now());

        const programas = await response.json();

        const container = document.getElementById('radio-container');
        container.innerHTML = '';

        let temporadaActual = null;
        let esPrimerVideo = true;

        programas.forEach(programa => {
            if (programa.temporada !== temporadaActual) {
                
                if (!esPrimerVideo) {
                    const seasonBlock = document.createElement("div");
                    seasonBlock.className = "video-item";
                    seasonBlock.innerHTML = `<div class="video-placeholder">TEMPORADA ${programa.temporada} ></div>`;
                    container.appendChild(seasonBlock);
                }

                temporadaActual = programa.temporada;
            }

            
            const item = document.createElement("div");
            item.classList.add("video-item");
            if (programa.destacado) {
              item.classList.add("featured")
            }
            item.setAttribute("data-temporada", programa.temporada);
            item.setAttribute("data-tags", programa.etiquetas || '');

            item.innerHTML = `
                <a href="${programa.url}">
                    <div class="duration">${programa.duracion}</div>
                    <img src="${programa.imagen}" alt="${programa.titulo}" loading="lazy">
                </a>
                <div class="video-title">${programa.titulo}</div>
            `;

            container.appendChild(item);

            esPrimerVideo = false;
        });
    } catch (error) {
        console.error('Error cargando programas:', error);
    }
}

document.addEventListener('DOMContentLoaded', cargarProgramas);
    </script>
    <script>
        async function cargarProgramas() {
    try {
        const response = await fetch('https://gabbaapp.s3.us-east-1.amazonaws.com/videos.json?t' + Date.now());
        const programas = await response.json();

        const container = document.getElementById('video-container');
        container.innerHTML = '';

        let temporadaActual = null;
        let esPrimerVideo = true;

        programas.forEach(programa => {
            if (programa.temporada !== temporadaActual) {
                
                if (!esPrimerVideo) {
                    const seasonBlock = document.createElement("div");
                    seasonBlock.className = "video-item";
                    seasonBlock.innerHTML = `<div class="video-placeholder">TEMPORADA ${programa.temporada} ></div>`;
                    container.appendChild(seasonBlock);
                }

                temporadaActual = programa.temporada;
            }

            
            const item = document.createElement("div");
            item.classList.add("video-item");
            if (programa.destacado) {
              item.classList.add("featured")
            }
            item.setAttribute("data-temporada", programa.temporada);
            item.setAttribute("data-tags", programa.etiquetas || '');

            item.innerHTML = `
                <a href="${programa.url}">
                    <div class="duration">${programa.duracion}</div>
                    <img src="${programa.imagen}" alt="${programa.titulo}" loading="lazy">
                </a>
                <div class="video-title">${programa.titulo}</div>
            `;

            container.appendChild(item);

            esPrimerVideo = false;
        });
    } catch (error) {
        console.error('Error cargando programas:', error);
    }
}

document.addEventListener('DOMContentLoaded', cargarProgramas);
    </script>
    <script>
      async function cargarEventos() {
    try {
        const response = await fetch('https://gabbaapp.s3.us-east-1.amazonaws.com/eventos.json?t=' + Date.now());

        if (!response.ok) {
            throw new Error(`HTTP error! Status: ${response.status}`);
        }

        const eventos = await response.json();

        const container = document.getElementById('event-container');
        container.innerHTML = ''; 

        if (!Array.isArray(eventos) || eventos.length === 0) {
            mostrarMensajeVacio(container);
            return;
        }

        eventos.forEach(evento => {
            const item = document.createElement('div');
            item.classList.add('event-item');

            const titulo = document.createElement('div');
            titulo.classList.add('event-title');
            titulo.textContent = evento.titulo;

            const flyer = document.createElement('div');
            flyer.classList.add('event-flyer');
            const imagen = document.createElement('img');
            imagen.src = evento.imagen;
            imagen.alt = evento.titulo;
            imagen.style.cursor = "pointer";

            flyer.appendChild(imagen);

            const info = document.createElement('div');
            info.classList.add('event-info');
            info.innerHTML = `
              <div class="event-date">${evento.fecha}, ${evento.hora}</div>
              <div class="event-location">
                <a href="${evento.ubicacion}" target="_blank">
                  <span class="material-symbols-rounded">location_on</span>
                </a>
                ${evento.lugar}
              </div>
          `;
          
          const body = document.createElement('div');
          body.classList.add('event-body');
          body.appendChild(flyer);
          body.appendChild(info);

          const boton = document.createElement('a');
          boton.href = evento.link_compra;
          boton.classList.add('event-button');
          boton.target = "_blank";
          boton.innerText = evento.texto_boton || "COMPRAR ENTRADAS";

          item.appendChild(titulo);
          item.appendChild(body);
          item.appendChild(boton);

          container.appendChild(item);
      });



    } catch (error) {
        console.error('Error cargando eventos:', error);
        const container = document.getElementById('event-container');
        if (container) mostrarMensajeVacio(container);
    }
}

function mostrarMensajeVacio(container) {
    container.innerHTML = '';
    const mensaje = document.createElement('div');
    mensaje.classList.add('event-empty');
    mensaje.innerHTML = `
        Estate atento a nuestro 
        <a href="https://instagram.com/gabba.gabba.fest" target="_blank" class="event-empty-link">
            Instagram
        </a> 
        que estaremos anunciando una nueva fecha próximamente!
    `;
    container.appendChild(mensaje);
}

document.addEventListener('DOMContentLoaded', cargarEventos);
    </script>
    <script src="js/overlay.js"></script>
</body>
</html>